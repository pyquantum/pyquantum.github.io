

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="python" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="python" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>piqs.dicke &mdash; piqs 1.1-dev documentation</title>
  

  
  
  
  

  

  
  
    

  

  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> piqs
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../guide.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../piqs.html">Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../developers.html">Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../references.html">References</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">piqs</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
      <li>piqs.dicke</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for piqs.dicke</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;Permutational Invariant Quantum Solver (PIQS)</span>

<span class="sd">This module calculates the Liouvillian for the dynamics of ensembles of</span>
<span class="sd">identical two-level systems (TLS) in the presence of local and collective</span>
<span class="sd">processes by exploiting permutational symmetry and using the Dicke basis.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c1"># Authors: Nathan Shammah, Shahnawaz Ahmed</span>
<span class="c1"># Contact: nathan.shammah@gmail.com, shahnawaz.ahmed95@gmail.com</span>

<span class="kn">from</span> <span class="nn">math</span> <span class="k">import</span> <span class="n">factorial</span>
<span class="kn">from</span> <span class="nn">decimal</span> <span class="k">import</span> <span class="n">Decimal</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">constants</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="k">import</span> <span class="n">odeint</span>
<span class="kn">from</span> <span class="nn">scipy.sparse</span> <span class="k">import</span> <span class="n">dok_matrix</span><span class="p">,</span> <span class="n">block_diag</span><span class="p">,</span> <span class="n">lil_matrix</span>
<span class="kn">from</span> <span class="nn">qutip.solver</span> <span class="k">import</span> <span class="n">Options</span><span class="p">,</span> <span class="n">Result</span>
<span class="kn">from</span> <span class="nn">qutip</span> <span class="k">import</span> <span class="p">(</span><span class="n">Qobj</span><span class="p">,</span> <span class="n">spre</span><span class="p">,</span> <span class="n">spost</span><span class="p">,</span> <span class="n">tensor</span><span class="p">,</span> <span class="n">identity</span><span class="p">,</span> <span class="n">ket2dm</span><span class="p">,</span>
                   <span class="n">vector_to_operator</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">qutip</span> <span class="k">import</span> <span class="n">sigmax</span><span class="p">,</span> <span class="n">sigmay</span><span class="p">,</span> <span class="n">sigmaz</span><span class="p">,</span> <span class="n">sigmap</span><span class="p">,</span> <span class="n">sigmam</span>

<span class="kn">from</span> <span class="nn">piqs.cy.dicke</span> <span class="k">import</span> <span class="n">Dicke</span> <span class="k">as</span> <span class="n">_Dicke</span>
<span class="kn">from</span> <span class="nn">piqs.cy.dicke</span> <span class="k">import</span> <span class="p">(</span><span class="n">jmm1_dictionary</span><span class="p">,</span> <span class="n">_num_dicke_states</span><span class="p">,</span>
                           <span class="n">_num_dicke_ladders</span><span class="p">,</span> <span class="n">get_blocks</span><span class="p">,</span> <span class="n">j_min</span><span class="p">,</span>
                           <span class="n">m_vals</span><span class="p">,</span> <span class="n">j_vals</span><span class="p">)</span>


<span class="c1"># Functions necessary to generate the Lindbladian/Liouvillian</span>
<div class="viewcode-block" id="num_dicke_states"><a class="viewcode-back" href="../../piqs.html#piqs.dicke.num_dicke_states">[docs]</a><span class="k">def</span> <span class="nf">num_dicke_states</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculate the number of Dicke states.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    N: int</span>
<span class="sd">        The number of two-level systems.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    nds: int</span>
<span class="sd">        The number of Dicke states.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_num_dicke_states</span><span class="p">(</span><span class="n">N</span><span class="p">)</span></div>

<div class="viewcode-block" id="num_dicke_ladders"><a class="viewcode-back" href="../../piqs.html#piqs.dicke.num_dicke_ladders">[docs]</a><span class="k">def</span> <span class="nf">num_dicke_ladders</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculate the total number of ladders in the Dicke space.</span>

<span class="sd">    For a collection of N two-level systems it counts how many different</span>
<span class="sd">    &quot;j&quot; exist or the number of blocks in the block-diagonal matrix.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    N: int</span>
<span class="sd">        The number of two-level systems.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Nj: int</span>
<span class="sd">        The number of Dicke ladders.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_num_dicke_ladders</span><span class="p">(</span><span class="n">N</span><span class="p">)</span></div>

<div class="viewcode-block" id="num_tls"><a class="viewcode-back" href="../../piqs.html#piqs.dicke.num_tls">[docs]</a><span class="k">def</span> <span class="nf">num_tls</span><span class="p">(</span><span class="n">nds</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculate the number of two-level systems.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    nds: int</span>
<span class="sd">         The number of Dicke states.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    N: int</span>
<span class="sd">        The number of two-level systems.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">nds</span><span class="p">)</span><span class="o">.</span><span class="n">is_integer</span><span class="p">():</span>
        <span class="c1"># N is even</span>
        <span class="n">N</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">nds</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># N is odd</span>
        <span class="n">N</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">nds</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">N</span><span class="p">)</span></div>

<div class="viewcode-block" id="isdiagonal"><a class="viewcode-back" href="../../piqs.html#piqs.dicke.isdiagonal">[docs]</a><span class="k">def</span> <span class="nf">isdiagonal</span><span class="p">(</span><span class="n">mat</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check if the input matrix is diagonal</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>
<span class="sd">    mat: ndarray/Qobj</span>
<span class="sd">        A 2D numpy array</span>

<span class="sd">    Returns</span>
<span class="sd">    =======</span>
<span class="sd">    diag: bool</span>
<span class="sd">        True/False depending on whether the input matrix is diagonal</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="n">Qobj</span><span class="p">):</span>
        <span class="n">mat</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">full</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">mat</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diagonal</span><span class="p">(</span><span class="n">mat</span><span class="p">)))</span></div>


<div class="viewcode-block" id="Dicke"><a class="viewcode-back" href="../../piqs.html#piqs.dicke.Dicke">[docs]</a><span class="k">class</span> <span class="nc">Dicke</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The Dicke class which builds the Lindbladian and Liouvillian matrix.</span>

<span class="sd">    Example</span>
<span class="sd">    -------</span>
<span class="sd">    &gt;&gt;&gt; from piqs import Dicke, jspin</span>
<span class="sd">    &gt;&gt;&gt; N = 2</span>
<span class="sd">    &gt;&gt;&gt; jx, jy, jz = jspin(N)</span>
<span class="sd">    &gt;&gt;&gt; jp = jspin(N, &quot;+&quot;)</span>
<span class="sd">    &gt;&gt;&gt; jm = jspin(N, &quot;-&quot;)</span>
<span class="sd">    &gt;&gt;&gt; ensemble = Dicke(N, emission=1.)</span>
<span class="sd">    &gt;&gt;&gt; L = ensemble.liouvillian()</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    N: int</span>
<span class="sd">        The number of two-level systems.</span>

<span class="sd">    hamiltonian: :class: qutip.Qobj</span>
<span class="sd">        A Hamiltonian in the Dicke basis.</span>

<span class="sd">        The matrix dimensions are (nds, nds), </span>
<span class="sd">        with nds being the number of Dicke states. </span>
<span class="sd">        The Hamiltonian can be built with the operators </span>
<span class="sd">        given by the `jspin` functions.</span>

<span class="sd">    emission: float</span>
<span class="sd">        Incoherent emission coefficient (also nonradiative emission).</span>
<span class="sd">        default: 0.0</span>

<span class="sd">    dephasing: float</span>
<span class="sd">        Local dephasing coefficient.</span>
<span class="sd">        default: 0.0</span>

<span class="sd">    pumping: float</span>
<span class="sd">        Incoherent pumping coefficient.</span>
<span class="sd">        default: 0.0</span>

<span class="sd">    collective_emission: float</span>
<span class="sd">        Collective (superradiant) emmission coefficient.</span>
<span class="sd">        default: 0.0</span>

<span class="sd">    collective_pumping: float</span>
<span class="sd">        Collective pumping coefficient.</span>
<span class="sd">        default: 0.0</span>

<span class="sd">    collective_dephasing: float</span>
<span class="sd">        Collective dephasing coefficient.</span>
<span class="sd">        default: 0.0</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    N: int</span>
<span class="sd">        The number of two-level systems.</span>

<span class="sd">    hamiltonian: :class: qutip.Qobj</span>
<span class="sd">        A Hamiltonian in the Dicke basis.</span>

<span class="sd">        The matrix dimensions are (nds, nds), </span>
<span class="sd">        with nds being the number of Dicke states. </span>
<span class="sd">        The Hamiltonian can be built with the operators given</span>
<span class="sd">        by the `jspin` function in the &quot;dicke&quot; basis.</span>

<span class="sd">    emission: float</span>
<span class="sd">        Incoherent emission coefficient (also nonradiative emission).</span>
<span class="sd">        default: 0.0</span>

<span class="sd">    dephasing: float</span>
<span class="sd">        Local dephasing coefficient.</span>
<span class="sd">        default: 0.0</span>

<span class="sd">    pumping: float</span>
<span class="sd">        Incoherent pumping coefficient.</span>
<span class="sd">        default: 0.0</span>

<span class="sd">    collective_emission: float</span>
<span class="sd">        Collective (superradiant) emmission coefficient.</span>
<span class="sd">        default: 0.0</span>

<span class="sd">    collective_dephasing: float</span>
<span class="sd">        Collective dephasing coefficient.</span>
<span class="sd">        default: 0.0</span>

<span class="sd">    collective_pumping: float</span>
<span class="sd">        Collective pumping coefficient.</span>
<span class="sd">        default: 0.0</span>

<span class="sd">    nds: int</span>
<span class="sd">        The number of Dicke states.</span>

<span class="sd">    dshape: tuple</span>
<span class="sd">        The shape of the Hilbert space in the Dicke or uncoupled basis. </span>
<span class="sd">        default: (nds, nds).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">hamiltonian</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">emission</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">dephasing</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">pumping</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span>
                 <span class="n">collective_emission</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">collective_dephasing</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span>
                 <span class="n">collective_pumping</span><span class="o">=</span><span class="mf">0.</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">N</span> <span class="o">=</span> <span class="n">N</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hamiltonian</span> <span class="o">=</span> <span class="n">hamiltonian</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">emission</span> <span class="o">=</span> <span class="n">emission</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dephasing</span> <span class="o">=</span> <span class="n">dephasing</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pumping</span> <span class="o">=</span> <span class="n">pumping</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">collective_emission</span> <span class="o">=</span> <span class="n">collective_emission</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">collective_dephasing</span> <span class="o">=</span> <span class="n">collective_dephasing</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">collective_pumping</span> <span class="o">=</span> <span class="n">collective_pumping</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nds</span> <span class="o">=</span> <span class="n">num_dicke_states</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dshape</span> <span class="o">=</span> <span class="p">(</span><span class="n">num_dicke_states</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">),</span> <span class="n">num_dicke_states</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">))</span>

<div class="viewcode-block" id="Dicke.__repr__"><a class="viewcode-back" href="../../piqs.html#piqs.dicke.Dicke.__repr__">[docs]</a>    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Print the current parameters of the system.&quot;&quot;&quot;</span>
        <span class="n">string</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;N = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">))</span>
        <span class="n">string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Hilbert space dim = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dshape</span><span class="p">))</span>
        <span class="n">string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Number of Dicke states = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nds</span><span class="p">))</span>
        <span class="n">string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Liouvillian space dim = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">nds</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span>
                                                           <span class="bp">self</span><span class="o">.</span><span class="n">nds</span><span class="o">**</span><span class="mi">2</span><span class="p">)))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">emission</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;emission = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">emission</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dephasing</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;dephasing = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dephasing</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pumping</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;pumping = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pumping</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">collective_emission</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="s2">&quot;collective_emission = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">collective_emission</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">collective_dephasing</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="s2">&quot;collective_dephasing = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">collective_dephasing</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">collective_pumping</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="s2">&quot;collective_pumping = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">collective_pumping</span><span class="p">))</span>
        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">string</span><span class="p">)</span></div>

<div class="viewcode-block" id="Dicke.lindbladian"><a class="viewcode-back" href="../../piqs.html#piqs.dicke.Dicke.lindbladian">[docs]</a>    <span class="k">def</span> <span class="nf">lindbladian</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Build the Lindbladian superoperator of the dissipative dynamics.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        lindbladian: :class: qutip.Qobj</span>
<span class="sd">            The Lindbladian matrix as a `qutip.Qobj`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cythonized_dicke</span> <span class="o">=</span> <span class="n">_Dicke</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">),</span>
                                  <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">emission</span><span class="p">),</span>
                                  <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dephasing</span><span class="p">),</span>
                                  <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pumping</span><span class="p">),</span>
                                  <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">collective_emission</span><span class="p">),</span>
                                  <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">collective_dephasing</span><span class="p">),</span>
                                  <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">collective_pumping</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">cythonized_dicke</span><span class="o">.</span><span class="n">lindbladian</span><span class="p">()</span></div>

<div class="viewcode-block" id="Dicke.liouvillian"><a class="viewcode-back" href="../../piqs.html#piqs.dicke.Dicke.liouvillian">[docs]</a>    <span class="k">def</span> <span class="nf">liouvillian</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Build the total Liouvillian using the Dicke basis.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        liouv: :class: qutip.Qobj</span>
<span class="sd">            The Liouvillian matrix for the system.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">lindblad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lindbladian</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hamiltonian</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">liouv</span> <span class="o">=</span> <span class="n">lindblad</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">hamiltonian</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hamiltonian</span>
            <span class="n">hamiltonian_superoperator</span> <span class="o">=</span> <span class="o">-</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> \
                <span class="n">spre</span><span class="p">(</span><span class="n">hamiltonian</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">spost</span><span class="p">(</span><span class="n">hamiltonian</span><span class="p">)</span>
            <span class="n">liouv</span> <span class="o">=</span> <span class="n">lindblad</span> <span class="o">+</span> <span class="n">hamiltonian_superoperator</span>
        <span class="k">return</span> <span class="n">liouv</span></div>

<div class="viewcode-block" id="Dicke.pisolve"><a class="viewcode-back" href="../../piqs.html#piqs.dicke.Dicke.pisolve">[docs]</a>    <span class="k">def</span> <span class="nf">pisolve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">initial_state</span><span class="p">,</span> <span class="n">tlist</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Solve for diagonal Hamiltonians and initial states faster.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ==========</span>
<span class="sd">        initial_state: :class: qutip.Qobj</span>
<span class="sd">            An initial state specified as a density matrix of `qutip.Qbj` type</span>

<span class="sd">        tlist: ndarray</span>
<span class="sd">            A 1D numpy array of list of timesteps to integrate</span>

<span class="sd">        options: :class: qutip.solver.Options</span>
<span class="sd">            The options for the solver.</span>

<span class="sd">        Returns</span>
<span class="sd">        =======</span>
<span class="sd">        result: list</span>
<span class="sd">            A dictionary of the type `qutip.solver.Result` which holds the</span>
<span class="sd">            results of the evolution.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">isdiagonal</span><span class="p">(</span><span class="n">initial_state</span><span class="p">)</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;`pisolve` requires a diagonal initial density matrix. &quot;</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot;In general construct the Liouvillian using `piqs.liouvillian`&quot;</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot; and use qutip.mesolve.&quot;</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hamiltonian</span> <span class="ow">and</span> <span class="n">isdiagonal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hamiltonian</span><span class="p">)</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;`pisolve` should only be used for diagonal Hamiltonians. &quot;</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot;Construct the Liouvillian using `piqs.liouvillian` and use&quot;</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot; `qutip.mesolve`.&quot;</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">initial_state</span><span class="o">.</span><span class="n">full</span><span class="p">()</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dshape</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Initial density matrix should be diagonal.&quot;</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="n">pim</span> <span class="o">=</span> <span class="n">Pim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">emission</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dephasing</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pumping</span><span class="p">,</span>
                  <span class="bp">self</span><span class="o">.</span><span class="n">collective_emission</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">collective_pumping</span><span class="p">,</span>
                  <span class="bp">self</span><span class="o">.</span><span class="n">collective_dephasing</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">pim</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">initial_state</span><span class="p">,</span> <span class="n">tlist</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="Dicke.prune_eigenstates"><a class="viewcode-back" href="../../piqs.html#piqs.dicke.Dicke.prune_eigenstates">[docs]</a>    <span class="k">def</span> <span class="nf">prune_eigenstates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">liouvillian</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove spurious eigenvalues and eigenvectors of the Liouvillian.</span>

<span class="sd">        Spurious means that the given eigenvector has elements outside of the</span>
<span class="sd">        block-diagonal matrix.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        liouvillian_eigenstates: list</span>
<span class="sd">            A list with the eigenvalues and eigenvectors of the Liouvillian</span>
<span class="sd">            including spurious ones.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        correct_eigenstates: list</span>
<span class="sd">            The list with the correct eigenvalues and eigenvectors of the</span>
<span class="sd">            Liouvillian.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">liouvillian_eigenstates</span> <span class="o">=</span> <span class="n">liouvillian</span><span class="o">.</span><span class="n">eigenstates</span><span class="p">()</span>
        <span class="n">N</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">N</span>
        <span class="n">block_mat</span> <span class="o">=</span> <span class="n">block_matrix</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">nnz_tuple_bm</span> <span class="o">=</span> <span class="p">[(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">block_mat</span><span class="o">.</span><span class="n">nonzero</span><span class="p">())]</span>

        <span class="c1"># 0. Create  a copy of the eigenvalues to approximate values</span>
        <span class="n">eig_val</span><span class="p">,</span> <span class="n">eig_vec</span> <span class="o">=</span> <span class="n">liouvillian_eigenstates</span>
        <span class="n">tol</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="n">eig_val_round</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">eig_val</span><span class="p">,</span> <span class="n">tol</span><span class="p">)</span>

        <span class="c1"># 2. Use &#39;block_matrix(N)&#39; to remove eigenvectors with matrix</span>
        <span class="c1"># elements</span>
        <span class="c1"># outside of the block matrix.</span>
        <span class="n">forbidden_eig_index</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">eig_vec</span><span class="p">)):</span>
            <span class="n">dm</span> <span class="o">=</span> <span class="n">vector_to_operator</span><span class="p">(</span><span class="n">eig_vec</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
            <span class="n">nnz_tuple</span> <span class="o">=</span> <span class="p">[(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">dm</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">nonzero</span><span class="p">())]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">nnz_tuple</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">nnz_tuple_bm</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">dm</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">tol</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">forbidden_eig_index</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>

        <span class="n">forbidden_eig_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">forbidden_eig_index</span><span class="p">)))</span>
        <span class="c1"># 3. Remove the forbidden eigenvalues and eigenvectors.</span>
        <span class="n">correct_eig_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">eig_val</span><span class="p">,</span> <span class="n">forbidden_eig_index</span><span class="p">)</span>
        <span class="n">correct_eig_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">eig_vec</span><span class="p">,</span> <span class="n">forbidden_eig_index</span><span class="p">)</span>
        <span class="n">correct_eigenstates</span> <span class="o">=</span> <span class="n">correct_eig_val</span><span class="p">,</span> <span class="n">correct_eig_vec</span>
        <span class="k">return</span> <span class="n">correct_eigenstates</span></div>

<div class="viewcode-block" id="Dicke.c_ops"><a class="viewcode-back" href="../../piqs.html#piqs.dicke.Dicke.c_ops">[docs]</a>    <span class="k">def</span> <span class="nf">c_ops</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Build collapse operators in the full Hilbert space 2^N.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        c_ops_list: list</span>
<span class="sd">            The list with the collapse operators in the 2^N Hilbert space.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">c_ops_list</span> <span class="o">=</span> <span class="n">collapse_uncoupled</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">,</span> 
                                        <span class="n">emission</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">emission</span><span class="p">,</span>
                                        <span class="n">dephasing</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dephasing</span><span class="p">,</span>
                                        <span class="n">pumping</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pumping</span><span class="p">,</span>
                                        <span class="n">collective_emission</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">collective_emission</span><span class="p">,</span>
                                        <span class="n">collective_dephasing</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">collective_dephasing</span><span class="p">,</span>
                                        <span class="n">collective_pumping</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">collective_pumping</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">c_ops_list</span></div>

<div class="viewcode-block" id="Dicke.coefficient_matrix"><a class="viewcode-back" href="../../piqs.html#piqs.dicke.Dicke.coefficient_matrix">[docs]</a>    <span class="k">def</span> <span class="nf">coefficient_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Build coefficient matrix for ODE for a diagonal problem.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        M: ndarray</span>
<span class="sd">            The matrix M of the coefficients for the ODE dp/dt = M p.</span>
<span class="sd">            p is the vector of the diagonal matrix elements</span>
<span class="sd">            of the density matrix rho in the Dicke basis.  </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">diagonal_system</span> <span class="o">=</span> <span class="n">Pim</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">,</span>
                              <span class="n">emission</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">emission</span><span class="p">,</span>
                              <span class="n">dephasing</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dephasing</span><span class="p">,</span>
                              <span class="n">pumping</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pumping</span><span class="p">,</span>
                              <span class="n">collective_emission</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">collective_emission</span><span class="p">,</span>
                              <span class="n">collective_dephasing</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">collective_dephasing</span><span class="p">,</span>
                              <span class="n">collective_pumping</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">collective_pumping</span><span class="p">)</span>
        <span class="n">coef_matrix</span> <span class="o">=</span> <span class="n">diagonal_system</span><span class="o">.</span><span class="n">coefficient_matrix</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">coef_matrix</span></div></div>


<span class="c1"># Utility functions for properties of the Dicke space</span>
<div class="viewcode-block" id="energy_degeneracy"><a class="viewcode-back" href="../../piqs.html#piqs.dicke.energy_degeneracy">[docs]</a><span class="k">def</span> <span class="nf">energy_degeneracy</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculate the number of Dicke states with same energy.</span>

<span class="sd">    The use of the `Decimals` class allows to explore N &gt; 1000,</span>
<span class="sd">    unlike the built-in function `scipy.special.binom`</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    N: int</span>
<span class="sd">        The number of two-level systems.</span>

<span class="sd">    m: float</span>
<span class="sd">        Total spin z-axis projection eigenvalue.</span>
<span class="sd">        This is proportional to the total energy.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    degeneracy: int</span>
<span class="sd">        The energy degeneracy</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">numerator</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">factorial</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>
    <span class="n">d1</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">factorial</span><span class="p">(</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">m</span><span class="p">))</span>
    <span class="n">d2</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">factorial</span><span class="p">(</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">))</span>
    <span class="n">degeneracy</span> <span class="o">=</span> <span class="n">numerator</span><span class="o">/</span><span class="p">(</span><span class="n">d1</span> <span class="o">*</span> <span class="n">d2</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">degeneracy</span><span class="p">)</span></div>

<div class="viewcode-block" id="state_degeneracy"><a class="viewcode-back" href="../../piqs.html#piqs.dicke.state_degeneracy">[docs]</a><span class="k">def</span> <span class="nf">state_degeneracy</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">j</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculate the degeneracy of the Dicke state.</span>

<span class="sd">    Each state |j, m&gt; includes D(N,j) irreducible representations |j, m,alpha&gt;</span>
<span class="sd">    Uses Decimals to calculate higher numerator and denominators numbers.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    N: int</span>
<span class="sd">        The number of two-level systems.</span>

<span class="sd">    j: float</span>
<span class="sd">        Total spin eigenvalue (cooperativity).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    degeneracy: int</span>
<span class="sd">        The state degeneracy.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;j value should be &gt;= 0&quot;</span><span class="p">)</span>
    <span class="n">numerator</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">factorial</span><span class="p">(</span><span class="n">N</span><span class="p">))</span> <span class="o">*</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">denominator_1</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">factorial</span><span class="p">(</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">denominator_2</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">factorial</span><span class="p">(</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">j</span><span class="p">))</span>
    <span class="n">degeneracy</span> <span class="o">=</span> <span class="n">numerator</span><span class="o">/</span><span class="p">(</span><span class="n">denominator_1</span> <span class="o">*</span> <span class="n">denominator_2</span><span class="p">)</span>
    <span class="n">degeneracy</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">degeneracy</span><span class="p">)))</span>
    <span class="k">return</span> <span class="n">degeneracy</span></div>

<div class="viewcode-block" id="m_degeneracy"><a class="viewcode-back" href="../../piqs.html#piqs.dicke.m_degeneracy">[docs]</a><span class="k">def</span> <span class="nf">m_degeneracy</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculate the number of Dicke states |j, m&gt; with same energy.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    N: int</span>
<span class="sd">        The number of two-level systems.</span>

<span class="sd">    m: float</span>
<span class="sd">        Total spin z-axis projection eigenvalue (proportional to the total</span>
<span class="sd">        energy).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    degeneracy: int</span>
<span class="sd">        The m-degeneracy.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">jvals</span> <span class="o">=</span> <span class="n">j_vals</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">maxj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">jvals</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">m</span> <span class="o">&lt;</span> <span class="o">-</span><span class="n">maxj</span><span class="p">:</span>
        <span class="n">e</span> <span class="o">=</span> <span class="s2">&quot;m value is incorrect for this N.&quot;</span>
        <span class="n">e</span> <span class="o">+=</span> <span class="s2">&quot; Minimum m value can be </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">-</span><span class="n">maxj</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="n">degeneracy</span> <span class="o">=</span> <span class="n">N</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">-</span> <span class="nb">abs</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">degeneracy</span><span class="p">)</span></div>

<div class="viewcode-block" id="ap"><a class="viewcode-back" href="../../piqs.html#piqs.dicke.ap">[docs]</a><span class="k">def</span> <span class="nf">ap</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculate the operator `ap` used later.</span>

<span class="sd">    The action of ap is given by: J_{+}|j, m&gt; = A_{+}(jm)|j, m+1&gt;</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    j, m: float</span>
<span class="sd">        The value for j and m in the dicke basis |j,m&gt;.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    a_plus: float</span>
<span class="sd">        The value of `a_plus`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a_plus</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">j</span><span class="o">-</span><span class="n">m</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">a_plus</span></div>

<div class="viewcode-block" id="am"><a class="viewcode-back" href="../../piqs.html#piqs.dicke.am">[docs]</a><span class="k">def</span> <span class="nf">am</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculate the operator `am` used later.</span>

<span class="sd">    The action of ap is given by: J_{-}|j, m&gt; = A_{-}(jm)|j, m-1&gt;</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    j, m: float</span>
<span class="sd">        The value for j and m in the dicke basis |j, m&gt;.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    a_minus: float</span>
<span class="sd">        The value of `a_minus`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a_minus</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">j</span><span class="o">+</span><span class="n">m</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">a_minus</span></div>

<div class="viewcode-block" id="spin_algebra"><a class="viewcode-back" href="../../piqs.html#piqs.dicke.spin_algebra">[docs]</a><span class="k">def</span> <span class="nf">spin_algebra</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">op</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Create the list [sx, sy, sz] with the spin operators.</span>

<span class="sd">    The operators are constructed for a collection of N two-level systems</span>
<span class="sd">    (TLSs). Each element of the list, i.e., sx, is a vector of `qutip.Qobj`</span>
<span class="sd">    objects (spin matrices), as it cointains the list of the SU(2) Pauli</span>
<span class="sd">    matrices for the N TLSs. Each TLS operator sx[i], with i = 0, ..., (N-1),</span>
<span class="sd">    is placed in a 2^N-dimensional Hilbert space.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    sx[i] is sigmax()/2 in the composite Hilbert space.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    N: int</span>
<span class="sd">        The number of two-level systems.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    spin_operators: list or :class: qutip.Qobj</span>
<span class="sd">        A list of `qutip.Qobj` operators - [sx, sy, sz] or the</span>
<span class="sd">        requested operator.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># 1. Define N TLS spin-1/2 matrices in the uncoupled basis</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">sx</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
    <span class="n">sy</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
    <span class="n">sz</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
    <span class="n">sp</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
    <span class="n">sm</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>

    <span class="n">sx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">sigmax</span><span class="p">()</span>
    <span class="n">sy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">sigmay</span><span class="p">()</span>
    <span class="n">sz</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">sigmaz</span><span class="p">()</span>
    <span class="n">sp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">sigmap</span><span class="p">()</span>
    <span class="n">sm</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">sigmam</span><span class="p">()</span>

    <span class="c1"># 2. Place operators in total Hilbert space</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">sx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">(</span><span class="n">sx</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">identity</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">sy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">(</span><span class="n">sy</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">identity</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">sz</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">(</span><span class="n">sz</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">identity</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">sp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">(</span><span class="n">sp</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">identity</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">sm</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">(</span><span class="n">sm</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">identity</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>

    <span class="c1"># 3. Cyclic sequence to create all N operators</span>
    <span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
    <span class="n">b</span> <span class="o">=</span> <span class="p">[[</span><span class="n">a</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="n">i2</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>

    <span class="c1"># 4. Create N operators</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
        <span class="n">sx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">sx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">permute</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">sy</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">sy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">permute</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">sz</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">sz</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">permute</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">sp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">sp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">permute</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">sm</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">sm</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">permute</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

    <span class="n">spin_operators</span> <span class="o">=</span> <span class="p">[</span><span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">,</span> <span class="n">sz</span><span class="p">]</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">op</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">spin_operators</span>
    <span class="k">elif</span> <span class="n">op</span> <span class="o">==</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">sx</span>
    <span class="k">elif</span> <span class="n">op</span> <span class="o">==</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">sy</span>
    <span class="k">elif</span> <span class="n">op</span> <span class="o">==</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">sz</span>
    <span class="k">elif</span> <span class="n">op</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">sp</span>
    <span class="k">elif</span> <span class="n">op</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">sm</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Invalid type&#39;</span><span class="p">)</span></div>

<span class="k">def</span> <span class="nf">_jspin_uncoupled</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">op</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Construct the the collective spin algebra in the uncoupled basis.</span>

<span class="sd">    jx, jy, jz, jp, jm are constructed in the uncoupled basis of the</span>
<span class="sd">    two-level system (TLS). Each collective operator is placed in a</span>
<span class="sd">    Hilbert space of dimension 2^N.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    N: int</span>
<span class="sd">        The number of two-level systems.</span>

<span class="sd">    op: str</span>
<span class="sd">        The operator to return &#39;x&#39;,&#39;y&#39;,&#39;z&#39;,&#39;+&#39;,&#39;-&#39;.</span>
<span class="sd">        If no operator given, then output is the list of operators</span>
<span class="sd">        for [&#39;x&#39;,&#39;y&#39;,&#39;z&#39;,].</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    collective_operators: list or :class: qutip.Qobj</span>
<span class="sd">        A list of `qutip.Qobj` representing all the operators in</span>
<span class="sd">        uncoupled&quot; basis or a single operator requested.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># 1. Define N TLS spin-1/2 matrices in the uncoupled basis</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

    <span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">,</span> <span class="n">sz</span> <span class="o">=</span> <span class="n">spin_algebra</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">sp</span><span class="p">,</span> <span class="n">sm</span> <span class="o">=</span> <span class="n">spin_algebra</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="s2">&quot;+&quot;</span><span class="p">),</span> <span class="n">spin_algebra</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">)</span>

    <span class="n">jx</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">sx</span><span class="p">)</span>
    <span class="n">jy</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">sy</span><span class="p">)</span>
    <span class="n">jz</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">sz</span><span class="p">)</span>
    <span class="n">jp</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">sp</span><span class="p">)</span>
    <span class="n">jm</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">sm</span><span class="p">)</span>

    <span class="n">collective_operators</span> <span class="o">=</span> <span class="p">[</span><span class="n">jx</span><span class="p">,</span> <span class="n">jy</span><span class="p">,</span> <span class="n">jz</span><span class="p">]</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">op</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">collective_operators</span>
    <span class="k">elif</span> <span class="n">op</span> <span class="o">==</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">jx</span>
    <span class="k">elif</span> <span class="n">op</span> <span class="o">==</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">jy</span>
    <span class="k">elif</span> <span class="n">op</span> <span class="o">==</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">jz</span>
    <span class="k">elif</span> <span class="n">op</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">jp</span>
    <span class="k">elif</span> <span class="n">op</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">jm</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Invalid type&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="jspin"><a class="viewcode-back" href="../../piqs.html#piqs.dicke.jspin">[docs]</a><span class="k">def</span> <span class="nf">jspin</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">op</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s2">&quot;dicke&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the list of collective operators of the total algebra.</span>

<span class="sd">    The Dicke basis |j,m&gt;&lt;j,m&#39;| is used by default. Otherwise with &quot;uncoupled&quot;</span>
<span class="sd">    the operators are in a 2^N space.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    N: int</span>
<span class="sd">        Number of two-level systems.</span>

<span class="sd">    op: str</span>
<span class="sd">        The operator to return &#39;x&#39;,&#39;y&#39;,&#39;z&#39;,&#39;+&#39;,&#39;-&#39;.</span>
<span class="sd">        If no operator given, then output is the list of operators</span>
<span class="sd">        for [&#39;x&#39;,&#39;y&#39;,&#39;z&#39;].</span>

<span class="sd">    basis: str</span>
<span class="sd">        The basis of the operators - &quot;dicke&quot; or &quot;uncoupled&quot;</span>
<span class="sd">        default: &quot;dicke&quot;.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    j_alg: list or :class: qutip.Qobj</span>
<span class="sd">        A list of `qutip.Qobj` representing all the operators in</span>
<span class="sd">        the &quot;dicke&quot; or &quot;uncoupled&quot; basis or a single operator requested.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">basis</span> <span class="o">==</span> <span class="s2">&quot;uncoupled&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">_jspin_uncoupled</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">op</span><span class="p">)</span>

    <span class="n">nds</span> <span class="o">=</span> <span class="n">num_dicke_states</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">num_ladders</span> <span class="o">=</span> <span class="n">num_dicke_ladders</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">jz_operator</span> <span class="o">=</span> <span class="n">dok_matrix</span><span class="p">((</span><span class="n">nds</span><span class="p">,</span> <span class="n">nds</span><span class="p">))</span>
    <span class="n">jp_operator</span> <span class="o">=</span> <span class="n">dok_matrix</span><span class="p">((</span><span class="n">nds</span><span class="p">,</span> <span class="n">nds</span><span class="p">))</span>
    <span class="n">jm_operator</span> <span class="o">=</span> <span class="n">dok_matrix</span><span class="p">((</span><span class="n">nds</span><span class="p">,</span> <span class="n">nds</span><span class="p">))</span>
    <span class="n">s</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_ladders</span><span class="p">):</span>
        <span class="n">j</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">N</span> <span class="o">-</span> <span class="n">k</span>
        <span class="n">mmax</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">mmax</span><span class="p">):</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">j</span><span class="o">-</span><span class="n">i</span>
            <span class="n">jz_operator</span><span class="p">[</span><span class="n">s</span><span class="p">,</span> <span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="n">m</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">nds</span><span class="p">):</span>
                <span class="n">jp_operator</span><span class="p">[</span><span class="n">s</span><span class="p">,</span> <span class="n">s</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">ap</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">m</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">nds</span><span class="p">):</span>
                <span class="n">jm_operator</span><span class="p">[</span><span class="n">s</span><span class="p">,</span> <span class="n">s</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">am</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">+</span><span class="mi">1</span>

    <span class="n">jx_operator</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">jp_operator</span><span class="o">+</span><span class="n">jm_operator</span><span class="p">)</span>
    <span class="n">jy_operator</span> <span class="o">=</span> <span class="mi">1</span><span class="n">j</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">jm_operator</span><span class="o">-</span><span class="n">jp_operator</span><span class="p">)</span>
    <span class="n">jx</span> <span class="o">=</span> <span class="n">Qobj</span><span class="p">(</span><span class="n">jx_operator</span><span class="p">)</span>
    <span class="n">jy</span> <span class="o">=</span> <span class="n">Qobj</span><span class="p">(</span><span class="n">jy_operator</span><span class="p">)</span>
    <span class="n">jz</span> <span class="o">=</span> <span class="n">Qobj</span><span class="p">(</span><span class="n">jz_operator</span><span class="p">)</span>
    <span class="n">jp</span> <span class="o">=</span> <span class="n">Qobj</span><span class="p">(</span><span class="n">jp_operator</span><span class="p">)</span>
    <span class="n">jm</span> <span class="o">=</span> <span class="n">Qobj</span><span class="p">(</span><span class="n">jm_operator</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">op</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">jx</span><span class="p">,</span> <span class="n">jy</span><span class="p">,</span> <span class="n">jz</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">op</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">jp</span>
    <span class="k">elif</span> <span class="n">op</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">jm</span>
    <span class="k">elif</span> <span class="n">op</span> <span class="o">==</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">jx</span>
    <span class="k">elif</span> <span class="n">op</span> <span class="o">==</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">jy</span>
    <span class="k">elif</span> <span class="n">op</span> <span class="o">==</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">jz</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Invalid type&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="collapse_uncoupled"><a class="viewcode-back" href="../../piqs.html#piqs.dicke.collapse_uncoupled">[docs]</a><span class="k">def</span> <span class="nf">collapse_uncoupled</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">emission</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">dephasing</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">pumping</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span>
              <span class="n">collective_emission</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">collective_dephasing</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span>
              <span class="n">collective_pumping</span><span class="o">=</span><span class="mf">0.</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create the collapse operators (c_ops) of the Lindbladian in the uncoupled basis.</span>

<span class="sd">    These operators are in the uncoupled basis of the two-level system</span>
<span class="sd">    (TLS) SU(2) Pauli matrices.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The collapse operator list can be given to `qutip.mesolve`.</span>
<span class="sd">    Notice that the operators are placed in a Hilbert space of dimension 2^N.</span>
<span class="sd">    Thus the method is suitable only for small N (of the order of 10).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    N: int</span>
<span class="sd">        The number of two-level systems.</span>

<span class="sd">    emission: float</span>
<span class="sd">        Incoherent emission coefficient (also nonradiative emission).</span>
<span class="sd">        default: 0.0</span>

<span class="sd">    dephasing: float</span>
<span class="sd">        Local dephasing coefficient.</span>
<span class="sd">        default: 0.0</span>

<span class="sd">    pumping: float</span>
<span class="sd">        Incoherent pumping coefficient.</span>
<span class="sd">        default: 0.0</span>

<span class="sd">    collective_emission: float</span>
<span class="sd">        Collective (superradiant) emmission coefficient.</span>
<span class="sd">        default: 0.0</span>

<span class="sd">    collective_pumping: float</span>
<span class="sd">        Collective pumping coefficient.</span>
<span class="sd">        default: 0.0</span>

<span class="sd">    collective_dephasing: float</span>
<span class="sd">        Collective dephasing coefficient.</span>
<span class="sd">        default: 0.0</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    c_ops: list</span>
<span class="sd">        The list of collapse operators as `qutip.Qobj` for the system.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">N</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;N &gt; 10. dim(H) = 2^N. &quot;</span>
        <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot;Better use `piqs.lindbladian` to reduce Hilbert space &quot;</span>
        <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot;dimension and exploit permutational symmetry.&quot;</span>
        <span class="k">raise</span> <span class="ne">Warning</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="p">[</span><span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">,</span> <span class="n">sz</span><span class="p">]</span> <span class="o">=</span> <span class="n">spin_algebra</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">sp</span><span class="p">,</span> <span class="n">sm</span> <span class="o">=</span> <span class="n">spin_algebra</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="s2">&quot;+&quot;</span><span class="p">),</span> <span class="n">spin_algebra</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">)</span>
    <span class="p">[</span><span class="n">jx</span><span class="p">,</span> <span class="n">jy</span><span class="p">,</span> <span class="n">jz</span><span class="p">]</span> <span class="o">=</span> <span class="n">jspin</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s2">&quot;uncoupled&quot;</span><span class="p">)</span>
    <span class="n">jp</span><span class="p">,</span> <span class="n">jm</span> <span class="o">=</span> <span class="p">(</span><span class="n">jspin</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="n">basis</span> <span class="o">=</span> <span class="s2">&quot;uncoupled&quot;</span><span class="p">),</span>
              <span class="n">jspin</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s2">&quot;uncoupled&quot;</span><span class="p">))</span>

    <span class="n">c_ops</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="n">emission</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
            <span class="n">c_ops</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">emission</span><span class="p">)</span> <span class="o">*</span> <span class="n">sm</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">dephasing</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
            <span class="n">c_ops</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">dephasing</span><span class="p">)</span> <span class="o">*</span> <span class="n">sz</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">pumping</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
            <span class="n">c_ops</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pumping</span><span class="p">)</span> <span class="o">*</span> <span class="n">sp</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">collective_emission</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">c_ops</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">collective_emission</span><span class="p">)</span> <span class="o">*</span> <span class="n">jm</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">collective_dephasing</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">c_ops</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">collective_dephasing</span><span class="p">)</span> <span class="o">*</span> <span class="n">jz</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">collective_pumping</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">c_ops</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">collective_pumping</span><span class="p">)</span> <span class="o">*</span> <span class="n">jp</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">c_ops</span></div>

<span class="c1"># State definitions in the Dicke basis with an option for basis transformation</span>
<div class="viewcode-block" id="dicke_basis"><a class="viewcode-back" href="../../piqs.html#piqs.dicke.dicke_basis">[docs]</a><span class="k">def</span> <span class="nf">dicke_basis</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">jmm1</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize the density matrix of a Dicke state for several (j, m, m1).</span>

<span class="sd">    This function can be used to build arbitrary states in the Dicke basis</span>
<span class="sd">    |j, m&gt;&lt;j, m1|. We create coefficients for each (j, m, m1) value in the</span>
<span class="sd">    dictionary jmm1. For instance, if we start from the most excited state for</span>
<span class="sd">    N = 2, we have the following state represented as a density matrix of size</span>
<span class="sd">    (nds, nds) or</span>
<span class="sd">    (4, 4).</span>

<span class="sd">    1 0 0 0</span>
<span class="sd">    0 0 0 0</span>
<span class="sd">    0 0 0 0</span>
<span class="sd">    0 0 0 0</span>

<span class="sd">    The mapping for the (i, k) index of the density matrix to the |j, m&gt;</span>
<span class="sd">    values is given by the cythonized function `jmm1_dictionary`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    N: int</span>
<span class="sd">        The number of two-level systems.</span>

<span class="sd">    jmm1: dict</span>
<span class="sd">        A dictionary of {(j, m, m1): p} that gives a density p for the</span>
<span class="sd">        (j, m, m1) matrix element.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    rho: :class: qutip.Qobj</span>
<span class="sd">        The density matrix in the Dicke basis.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">jmm1</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Please specify the jmm1 values as a dictionary&quot;</span>
        <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot;or use the `excited(N)` function to create an&quot;</span>
        <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot;excited state where jmm1 = {(N/2, N/2, N/2): 1}&quot;</span>
        <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="n">nds</span> <span class="o">=</span> <span class="n">_num_dicke_states</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">rho</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nds</span><span class="p">,</span> <span class="n">nds</span><span class="p">))</span>
    <span class="n">jmm1_dict</span> <span class="o">=</span> <span class="n">jmm1_dictionary</span><span class="p">(</span><span class="n">N</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">jmm1</span><span class="p">:</span>
        <span class="n">i</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="n">jmm1_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="n">rho</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">jmm1</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">Qobj</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span></div>

<div class="viewcode-block" id="dicke"><a class="viewcode-back" href="../../piqs.html#piqs.dicke.dicke">[docs]</a><span class="k">def</span> <span class="nf">dicke</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate a Dicke state as a pure density matrix in the Dicke basis.</span>

<span class="sd">    For instance, if the superradiant state is given |j, m&gt; = |1, 0&gt; for N = 2,</span>
<span class="sd">    the state is represented as a density matrix of size (nds, nds) or (4, 4),</span>

<span class="sd">    0 0 0 0</span>
<span class="sd">    0 1 0 0</span>
<span class="sd">    0 0 0 0</span>
<span class="sd">    0 0 0 0</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    N: int</span>
<span class="sd">        The number of two-level systems.</span>

<span class="sd">    j: float</span>
<span class="sd">        The eigenvalue j of the Dicke state |j, m&gt;.</span>

<span class="sd">    m: float</span>
<span class="sd">        The eigenvalue m of the Dicke state |j, m&gt;.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    rho: :class: qutip.Qobj</span>
<span class="sd">        The density matrix.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nds</span> <span class="o">=</span> <span class="n">num_dicke_states</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">rho</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nds</span><span class="p">,</span> <span class="n">nds</span><span class="p">))</span>

    <span class="n">jmm1_dict</span> <span class="o">=</span> <span class="n">jmm1_dictionary</span><span class="p">(</span><span class="n">N</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">i</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="n">jmm1_dict</span><span class="p">[(</span><span class="n">j</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">m</span><span class="p">)]</span>
    <span class="n">rho</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>
    <span class="k">return</span> <span class="n">Qobj</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span></div>

<span class="c1"># Uncoupled states in the full Hilbert space. These are returned with the</span>
<span class="c1"># choice of the keyword argument `basis=&quot;uncoupled&quot;` in the state functions.</span>
<span class="k">def</span> <span class="nf">_uncoupled_excited</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate the density matrix of the excited Dicke state in the full</span>
<span class="sd">    2^N dimensional Hilbert space.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    N: int</span>
<span class="sd">        The number of two-level systems.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    psi0: :class: qutip.Qobj</span>
<span class="sd">        The density matrix for the excited state in the uncoupled basis.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">jz</span> <span class="o">=</span> <span class="n">jspin</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s2">&quot;uncoupled&quot;</span><span class="p">)</span>
    <span class="n">en</span><span class="p">,</span> <span class="n">vn</span> <span class="o">=</span> <span class="n">jz</span><span class="o">.</span><span class="n">eigenstates</span><span class="p">()</span>
    <span class="n">psi0</span> <span class="o">=</span> <span class="n">vn</span><span class="p">[</span><span class="mi">2</span><span class="o">**</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">ket2dm</span><span class="p">(</span><span class="n">psi0</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">_uncoupled_superradiant</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate the density matrix of a superradiant state in the full 2^N</span>
<span class="sd">    dimensional Hilbert space.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    N: int</span>
<span class="sd">        The number of two-level systems.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    psi0: :class: qutip.Qobj</span>
<span class="sd">        The density matrix for the superradiant state in the full Hilbert</span>
<span class="sd">        space.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">jz</span> <span class="o">=</span> <span class="n">jspin</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s2">&quot;uncoupled&quot;</span><span class="p">)</span>
    <span class="n">en</span><span class="p">,</span> <span class="n">vn</span> <span class="o">=</span> <span class="n">jz</span><span class="o">.</span><span class="n">eigenstates</span><span class="p">()</span>
    <span class="n">psi0</span> <span class="o">=</span> <span class="n">vn</span><span class="p">[</span><span class="mi">2</span><span class="o">**</span><span class="n">N</span> <span class="o">-</span> <span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">ket2dm</span><span class="p">(</span><span class="n">psi0</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">_uncoupled_ground</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate the density matrix of the ground state in the full 2^N</span>
<span class="sd">    dimensional Hilbert space.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    N: int</span>
<span class="sd">        The number of two-level systems.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    psi0: :class: qutip.Qobj</span>
<span class="sd">        The density matrix for the ground state in the full Hilbert space.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">jz</span> <span class="o">=</span> <span class="n">jspin</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s2">&quot;uncoupled&quot;</span><span class="p">)</span>
    <span class="n">en</span><span class="p">,</span> <span class="n">vn</span> <span class="o">=</span> <span class="n">jz</span><span class="o">.</span><span class="n">eigenstates</span><span class="p">()</span>
    <span class="n">psi0</span> <span class="o">=</span> <span class="n">vn</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">ket2dm</span><span class="p">(</span><span class="n">psi0</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">_uncoupled_ghz</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate the density matrix of the GHZ state in the full 2^N</span>
<span class="sd">    dimensional Hilbert space.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    N: int</span>
<span class="sd">        The number of two-level systems.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ghz: :class: qutip.Qobj</span>
<span class="sd">        The density matrix for the GHZ state in the full Hilbert space.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">rho</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="o">**</span><span class="n">N</span><span class="p">,</span> <span class="mi">2</span><span class="o">**</span><span class="n">N</span><span class="p">))</span>
    <span class="n">rho</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span>
    <span class="n">rho</span><span class="p">[</span><span class="mi">2</span><span class="o">**</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span>
    <span class="n">rho</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">**</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span>
    <span class="n">rho</span><span class="p">[</span><span class="mi">2</span><span class="o">**</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="o">**</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span>
    <span class="n">spin_dim</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="p">)]</span>
    <span class="n">spins_dims</span> <span class="o">=</span> <span class="nb">list</span><span class="p">((</span><span class="n">spin_dim</span><span class="p">,</span> <span class="n">spin_dim</span><span class="p">))</span>
    <span class="n">rho</span> <span class="o">=</span> <span class="n">Qobj</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="n">spins_dims</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">rho</span>

<span class="k">def</span> <span class="nf">_uncoupled_css</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate the density matrix of the CSS state in the full 2^N</span>
<span class="sd">    dimensional Hilbert space.</span>

<span class="sd">    The CSS states are non-entangled states given by</span>
<span class="sd">    |a, b&gt; =  \Prod_i (a|1&gt;_i + b|0&gt;_i).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    N: int</span>
<span class="sd">        The number of two-level systems.</span>

<span class="sd">    a: complex</span>
<span class="sd">        The coefficient of the |1_i&gt; state.</span>

<span class="sd">    b: complex</span>
<span class="sd">        The coefficient of the |0_i&gt; state.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    css: :class: qutip.Qobj</span>
<span class="sd">        The density matrix for the CSS state in the full Hilbert space.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="c1"># 1. Define i_th factorized density matrix in the uncoupled basis</span>
    <span class="n">rho_i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>
    <span class="n">rho_i</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">rho_i</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
    <span class="n">rho_i</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">rho_i</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
    <span class="n">rho_i</span> <span class="o">=</span> <span class="n">Qobj</span><span class="p">(</span><span class="n">rho_i</span><span class="p">)</span>
    <span class="n">rho</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
    <span class="n">rho</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">rho_i</span>
    <span class="c1"># 2. Place single-two-level-system density matrices in total Hilbert space</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">rho</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">identity</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
    <span class="c1"># 3. Cyclic sequence to create all N factorized density matrices</span>
    <span class="c1"># |CSS&gt;_i&lt;CSS|_i</span>
    <span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
    <span class="n">b</span> <span class="o">=</span> <span class="p">[[</span><span class="n">a</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="n">i2</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
    <span class="c1"># 4. Create all other N-1 factorized density matrices</span>
    <span class="c1"># |+&gt;&lt;+| = Prod_(i=1)^N |CSS&gt;_i&lt;CSS|_i</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
        <span class="n">rho</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">rho</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">permute</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">identity_i</span> <span class="o">=</span> <span class="n">Qobj</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">N</span><span class="p">),</span> <span class="n">dims</span><span class="o">=</span><span class="n">rho</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">dims</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">rho</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">rho_tot</span> <span class="o">=</span> <span class="n">identity_i</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
        <span class="n">rho_tot</span> <span class="o">=</span> <span class="n">rho_tot</span> <span class="o">*</span> <span class="n">rho</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">rho_tot</span>

<div class="viewcode-block" id="excited"><a class="viewcode-back" href="../../piqs.html#piqs.dicke.excited">[docs]</a><span class="k">def</span> <span class="nf">excited</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s2">&quot;dicke&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate the density matrix for the excited state.</span>

<span class="sd">    This state is given by |N/2, N/2&gt; in the default Dicke basis. If the</span>
<span class="sd">    argument `basis` is &quot;uncoupled&quot; then it generates the state in a</span>
<span class="sd">    2**N dim Hilbert space.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    N: int</span>
<span class="sd">        The number of two-level systems.</span>

<span class="sd">    basis: str</span>
<span class="sd">        The basis to use. Either &quot;dicke&quot; or &quot;uncoupled&quot;.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    state: :class: qutip.Qobj</span>
<span class="sd">        The excited state density matrix in the requested basis.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">basis</span> <span class="o">==</span> <span class="s2">&quot;uncoupled&quot;</span><span class="p">:</span>
        <span class="n">state</span> <span class="o">=</span> <span class="n">_uncoupled_excited</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">state</span>

    <span class="n">jmm1</span> <span class="o">=</span> <span class="p">{(</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">):</span> <span class="mi">1</span><span class="p">}</span>
    <span class="k">return</span> <span class="n">dicke_basis</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">jmm1</span><span class="p">)</span></div>

<div class="viewcode-block" id="superradiant"><a class="viewcode-back" href="../../piqs.html#piqs.dicke.superradiant">[docs]</a><span class="k">def</span> <span class="nf">superradiant</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s2">&quot;dicke&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate the density matrix of the superradiant state.</span>

<span class="sd">    This state is given by |N/2, 0&gt; or |N/2, 0.5&gt; in the Dicke basis.</span>
<span class="sd">    If the argument `basis` is &quot;uncoupled&quot; then it generates the state</span>
<span class="sd">    in a 2**N dim Hilbert space.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    N: int</span>
<span class="sd">        The number of two-level systems.</span>

<span class="sd">    basis: str</span>
<span class="sd">        The basis to use. Either &quot;dicke&quot; or &quot;uncoupled&quot;.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    state: :class: qutip.Qobj</span>
<span class="sd">        The superradiant state density matrix in the requested basis.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">basis</span> <span class="o">==</span> <span class="s2">&quot;uncoupled&quot;</span><span class="p">:</span>
        <span class="n">state</span> <span class="o">=</span> <span class="n">_uncoupled_superradiant</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">state</span>

    <span class="k">if</span> <span class="n">N</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">jmm1</span> <span class="o">=</span> <span class="p">{(</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span> <span class="mf">1.</span><span class="p">}</span>
        <span class="k">return</span> <span class="n">dicke_basis</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">jmm1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">jmm1</span> <span class="o">=</span> <span class="p">{(</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">):</span> <span class="mf">1.</span><span class="p">}</span>
    <span class="k">return</span> <span class="n">dicke_basis</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">jmm1</span><span class="p">)</span></div>

<div class="viewcode-block" id="css"><a class="viewcode-back" href="../../piqs.html#piqs.dicke.css">[docs]</a><span class="k">def</span> <span class="nf">css</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
        <span class="n">basis</span><span class="o">=</span><span class="s2">&quot;dicke&quot;</span><span class="p">,</span> <span class="n">coordinates</span><span class="o">=</span><span class="s2">&quot;cartesian&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate the density matrix of the Coherent Spin State (CSS).</span>

<span class="sd">    It can be defined as |CSS&gt;= Prod_i^N(a|1&gt;_i + b|0&gt;_i)</span>
<span class="sd">    with a = sin(theta/2), b = exp(1j*phi) * cos(theta/2).</span>
<span class="sd">    The default basis is that of Dicke space |j, m&gt; &lt; j, m&#39;|.</span>
<span class="sd">    The default state is the symmetric CSS, |CSS&gt; = |+&gt;.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    N: int</span>
<span class="sd">        The number of two-level systems.</span>

<span class="sd">    x, y: float</span>
<span class="sd">        The coefficients of the CSS state.</span>

<span class="sd">    basis: str</span>
<span class="sd">        The basis to use. Either &quot;dicke&quot; or &quot;uncoupled&quot;.</span>

<span class="sd">    coordinates: str</span>
<span class="sd">        Either &quot;cartesian&quot; or &quot;polar&quot;. If polar then the coefficients</span>
<span class="sd">        are constructed as sin(x/2), cos(x/2)e^(iy).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    rho: :class: qutip.Qobj</span>
<span class="sd">        The CSS state density matrix.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">coordinates</span> <span class="o">==</span> <span class="s2">&quot;polar&quot;</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">y</span><span class="p">)</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">x</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">y</span>
    <span class="k">if</span> <span class="n">basis</span> <span class="o">==</span> <span class="s2">&quot;uncoupled&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">_uncoupled_css</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
    <span class="n">nds</span> <span class="o">=</span> <span class="n">num_dicke_states</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">num_ladders</span> <span class="o">=</span> <span class="n">num_dicke_ladders</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">rho</span> <span class="o">=</span> <span class="n">dok_matrix</span><span class="p">((</span><span class="n">nds</span><span class="p">,</span> <span class="n">nds</span><span class="p">))</span>

    <span class="c1"># loop in the allowed matrix elements</span>
    <span class="n">jmm1_dict</span> <span class="o">=</span> <span class="n">jmm1_dictionary</span><span class="p">(</span><span class="n">N</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">j</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">N</span>
    <span class="n">mmax</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">mmax</span><span class="p">):</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">j</span><span class="o">-</span><span class="n">i</span>
        <span class="n">psi_m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">energy_degeneracy</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">m</span><span class="p">)))</span> <span class="o">*</span> \
            <span class="n">a</span><span class="o">**</span><span class="p">(</span><span class="n">N</span><span class="o">*</span><span class="mf">0.5</span> <span class="o">+</span> <span class="n">m</span><span class="p">)</span> <span class="o">*</span> <span class="n">b</span><span class="o">**</span><span class="p">(</span><span class="n">N</span><span class="o">*</span><span class="mf">0.5</span> <span class="o">-</span> <span class="n">m</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">mmax</span><span class="p">):</span>
            <span class="n">m1</span> <span class="o">=</span> <span class="n">j</span> <span class="o">-</span> <span class="n">i1</span>
            <span class="n">row_column</span> <span class="o">=</span> <span class="n">jmm1_dict</span><span class="p">[(</span><span class="n">j</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">m1</span><span class="p">)]</span>
            <span class="n">psi_m1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">energy_degeneracy</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">m1</span><span class="p">)))</span> <span class="o">*</span> \
                <span class="n">np</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">N</span><span class="o">*</span><span class="mf">0.5</span> <span class="o">+</span> <span class="n">m1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">N</span><span class="o">*</span><span class="mf">0.5</span> <span class="o">-</span> <span class="n">m1</span><span class="p">)</span>
            <span class="n">rho</span><span class="p">[</span><span class="n">row_column</span><span class="p">]</span> <span class="o">=</span> <span class="n">psi_m</span><span class="o">*</span><span class="n">psi_m1</span>
    <span class="k">return</span> <span class="n">Qobj</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span></div>

<div class="viewcode-block" id="ghz"><a class="viewcode-back" href="../../piqs.html#piqs.dicke.ghz">[docs]</a><span class="k">def</span> <span class="nf">ghz</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s2">&quot;dicke&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate the density matrix of the GHZ state.</span>

<span class="sd">    If the argument `basis` is &quot;uncoupled&quot; then it generates the state</span>
<span class="sd">    in a 2**N dim Hilbert space.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    N: int</span>
<span class="sd">        The number of two-level systems.</span>

<span class="sd">    basis: str</span>
<span class="sd">        The basis to use. Either &quot;dicke&quot; or &quot;uncoupled&quot;.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    state: :class: qutip.Qobj</span>
<span class="sd">        The GHZ state density matrix in the requested basis.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">basis</span> <span class="o">==</span> <span class="s2">&quot;uncoupled&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">_uncoupled_ghz</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">nds</span> <span class="o">=</span> <span class="n">_num_dicke_states</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">rho</span> <span class="o">=</span> <span class="n">dok_matrix</span><span class="p">((</span><span class="n">nds</span><span class="p">,</span> <span class="n">nds</span><span class="p">))</span>
    <span class="n">rho</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span>
    <span class="n">rho</span><span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">N</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span>
    <span class="n">rho</span><span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span>
    <span class="n">rho</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span>
    <span class="k">return</span> <span class="n">Qobj</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span></div>

<div class="viewcode-block" id="ground"><a class="viewcode-back" href="../../piqs.html#piqs.dicke.ground">[docs]</a><span class="k">def</span> <span class="nf">ground</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s2">&quot;dicke&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate the density matrix of the ground state.</span>

<span class="sd">    This state is given by |N/2, -N/2&gt; in the Dicke basis. If the argument</span>
<span class="sd">    `basis` is &quot;uncoupled&quot; then it generates the state in a 2**N dim Hilbert</span>
<span class="sd">    space.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    N: int</span>
<span class="sd">        The number of two-level systems.</span>

<span class="sd">    basis: str</span>
<span class="sd">        The basis to use. Either &quot;dicke&quot; or &quot;uncoupled&quot;</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    state: :class: qutip.Qobj</span>
<span class="sd">        The ground state density matrix in the requested basis.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">basis</span> <span class="o">==</span> <span class="s2">&quot;uncoupled&quot;</span><span class="p">:</span>
        <span class="n">state</span> <span class="o">=</span> <span class="n">_uncoupled_ground</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">state</span>
    <span class="n">nds</span> <span class="o">=</span> <span class="n">_num_dicke_states</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">rho</span> <span class="o">=</span> <span class="n">dok_matrix</span><span class="p">((</span><span class="n">nds</span><span class="p">,</span> <span class="n">nds</span><span class="p">))</span>
    <span class="n">rho</span><span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">N</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">Qobj</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span></div>

<div class="viewcode-block" id="identity_uncoupled"><a class="viewcode-back" href="../../piqs.html#piqs.dicke.identity_uncoupled">[docs]</a><span class="k">def</span> <span class="nf">identity_uncoupled</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate the identity in a 2**N dimensional Hilbert space.</span>

<span class="sd">    The identity matrix is formed from the tensor product of N TLSs.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    N: int</span>
<span class="sd">        The number of two-level systems.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    identity: :class: qutip.Qobj</span>
<span class="sd">        The identity matrix.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">rho</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="o">**</span><span class="n">N</span><span class="p">,</span> <span class="mi">2</span><span class="o">**</span><span class="n">N</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">**</span><span class="n">N</span><span class="p">):</span>
        <span class="n">rho</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">spin_dim</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="p">)]</span>
    <span class="n">spins_dims</span> <span class="o">=</span> <span class="nb">list</span><span class="p">((</span><span class="n">spin_dim</span><span class="p">,</span> <span class="n">spin_dim</span><span class="p">))</span>
    <span class="n">identity</span> <span class="o">=</span> <span class="n">Qobj</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="n">spins_dims</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">identity</span></div>

<div class="viewcode-block" id="block_matrix"><a class="viewcode-back" href="../../piqs.html#piqs.dicke.block_matrix">[docs]</a><span class="k">def</span> <span class="nf">block_matrix</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Construct the block-diagonal matrix for the Dicke basis.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    N: int</span>
<span class="sd">        Number of two-level systems.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    block_matr: ndarray</span>
<span class="sd">        A 2D block-diagonal matrix of ones with dimension (nds,nds),</span>
<span class="sd">        where nds is the number of Dicke states for N two-level</span>
<span class="sd">        systems.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nds</span> <span class="o">=</span> <span class="n">_num_dicke_states</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="c1"># create a list with the sizes of the blocks, in order</span>
    <span class="n">blocks_dimensions</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">N</span> <span class="o">%</span> <span class="mi">2</span><span class="p">))</span>
    <span class="n">blocks_list</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span> <span class="o">*</span> <span class="p">(</span><span class="n">N</span> <span class="o">%</span> <span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span><span class="o">*</span><span class="p">((</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span><span class="p">))</span>
                   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">blocks_dimensions</span><span class="p">)]</span>
    <span class="n">blocks_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">blocks_list</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="c1"># create a list with each block matrix as element</span>
    <span class="n">square_blocks</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">blocks_list</span><span class="p">:</span>
        <span class="n">square_blocks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">)))</span>
        <span class="n">k</span> <span class="o">=</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">block_diag</span><span class="p">(</span><span class="n">square_blocks</span><span class="p">)</span></div>

<span class="c1"># ============================================================================</span>
<span class="c1"># Adding a faster version to make a Permutational Invariant matrix</span>
<span class="c1"># ============================================================================</span>
<div class="viewcode-block" id="tau_column"><a class="viewcode-back" href="../../piqs.html#piqs.dicke.tau_column">[docs]</a><span class="k">def</span> <span class="nf">tau_column</span><span class="p">(</span><span class="n">tau</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">j</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Determine the column index for the non-zero elements of the matrix for a</span>
<span class="sd">    particular row `k` and the value of `j` from the Dicke space.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    tau: str</span>
<span class="sd">        The tau function to check for this `k` and `j`.</span>

<span class="sd">    k: int</span>
<span class="sd">        The row of the matrix M for which the non zero elements have</span>
<span class="sd">        to be calculated.</span>

<span class="sd">    j: float</span>
<span class="sd">        The value of `j` for this row.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># In the notes, we indexed from k = 1, here we do it from k = 0</span>
    <span class="n">k</span> <span class="o">=</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">mapping</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;tau3&quot;</span><span class="p">:</span> <span class="n">k</span><span class="o">-</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">3</span><span class="p">),</span>
               <span class="s2">&quot;tau2&quot;</span><span class="p">:</span> <span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
               <span class="s2">&quot;tau4&quot;</span><span class="p">:</span> <span class="n">k</span><span class="o">+</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span>
               <span class="s2">&quot;tau5&quot;</span><span class="p">:</span> <span class="n">k</span><span class="o">-</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">2</span><span class="p">),</span>
               <span class="s2">&quot;tau1&quot;</span><span class="p">:</span> <span class="n">k</span><span class="p">,</span>
               <span class="s2">&quot;tau6&quot;</span><span class="p">:</span> <span class="n">k</span><span class="o">+</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">j</span><span class="p">),</span>
               <span class="s2">&quot;tau7&quot;</span><span class="p">:</span> <span class="n">k</span><span class="o">-</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
               <span class="s2">&quot;tau8&quot;</span><span class="p">:</span> <span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span>
               <span class="s2">&quot;tau9&quot;</span><span class="p">:</span> <span class="n">k</span><span class="o">+</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)}</span>
    <span class="c1"># we need to decrement k again as indexing is from 0</span>
    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">mapping</span><span class="p">[</span><span class="n">tau</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span></div>


<div class="viewcode-block" id="Pim"><a class="viewcode-back" href="../../piqs.html#piqs.dicke.Pim">[docs]</a><span class="k">class</span> <span class="nc">Pim</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The Permutation Invariant Matrix class.</span>

<span class="sd">    Initialize the class with the parameters for generating a Permutation</span>
<span class="sd">    Invariant matrix which evolves a given diagonal initial state `p` as:</span>

<span class="sd">                                dp/dt = Mp</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    N: int</span>
<span class="sd">        The number of two-level systems.</span>

<span class="sd">    emission: float</span>
<span class="sd">        Incoherent emission coefficient (also nonradiative emission).</span>
<span class="sd">        default: 0.0</span>

<span class="sd">    dephasing: float</span>
<span class="sd">        Local dephasing coefficient.</span>
<span class="sd">        default: 0.0</span>

<span class="sd">    pumping: float</span>
<span class="sd">        Incoherent pumping coefficient.</span>
<span class="sd">        default: 0.0</span>

<span class="sd">    collective_emission: float</span>
<span class="sd">        Collective (superradiant) emmission coefficient.</span>
<span class="sd">        default: 0.0</span>

<span class="sd">    collective_pumping: float</span>
<span class="sd">        Collective pumping coefficient.</span>
<span class="sd">        default: 0.0</span>

<span class="sd">    collective_dephasing: float</span>
<span class="sd">        Collective dephasing coefficient.</span>
<span class="sd">        default: 0.0</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    N: int</span>
<span class="sd">        The number of two-level systems.</span>

<span class="sd">    emission: float</span>
<span class="sd">        Incoherent emission coefficient (also nonradiative emission).</span>
<span class="sd">        default: 0.0</span>

<span class="sd">    dephasing: float</span>
<span class="sd">        Local dephasing coefficient.</span>
<span class="sd">        default: 0.0</span>

<span class="sd">    pumping: float</span>
<span class="sd">        Incoherent pumping coefficient.</span>
<span class="sd">        default: 0.0</span>

<span class="sd">    collective_emission: float</span>
<span class="sd">        Collective (superradiant) emmission coefficient.</span>
<span class="sd">        default: 0.0</span>

<span class="sd">    collective_dephasing: float</span>
<span class="sd">        Collective dephasing coefficient.</span>
<span class="sd">        default: 0.0</span>

<span class="sd">    collective_pumping: float</span>
<span class="sd">        Collective pumping coefficient.</span>
<span class="sd">        default: 0.0</span>

<span class="sd">    M: dict</span>
<span class="sd">        A nested dictionary of the structure {row: {col: val}} which holds</span>
<span class="sd">        non zero elements of the matrix M</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">emission</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">dephasing</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">pumping</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                 <span class="n">collective_emission</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">collective_pumping</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                 <span class="n">collective_dephasing</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">N</span> <span class="o">=</span> <span class="n">N</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">emission</span> <span class="o">=</span> <span class="n">emission</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dephasing</span> <span class="o">=</span> <span class="n">dephasing</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pumping</span> <span class="o">=</span> <span class="n">pumping</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">collective_pumping</span> <span class="o">=</span> <span class="n">collective_pumping</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">collective_dephasing</span> <span class="o">=</span> <span class="n">collective_dephasing</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">collective_emission</span> <span class="o">=</span> <span class="n">collective_emission</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">M</span> <span class="o">=</span> <span class="p">{}</span>

<div class="viewcode-block" id="Pim.isdicke"><a class="viewcode-back" href="../../piqs.html#piqs.dicke.Pim.isdicke">[docs]</a>    <span class="k">def</span> <span class="nf">isdicke</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dicke_row</span><span class="p">,</span> <span class="n">dicke_col</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check if an element in a matrix is a valid element in the Dicke space.</span>
<span class="sd">        Dicke row: j value index. Dicke column: m value index.</span>
<span class="sd">        The function returns True if the element exists in the Dicke space and</span>
<span class="sd">        False otherwise.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dicke_row, dicke_col : int</span>
<span class="sd">            Index of the element in Dicke space which needs to be checked</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">rows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">N</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">cols</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span> <span class="o">%</span> <span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">cols</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cols</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">dicke_row</span> <span class="o">&gt;</span> <span class="n">rows</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">dicke_row</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">dicke_col</span> <span class="o">&gt;</span> <span class="n">cols</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">dicke_col</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">dicke_row</span> <span class="o">&lt;</span> <span class="nb">int</span><span class="p">(</span><span class="n">rows</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span> <span class="ow">and</span> <span class="p">(</span><span class="n">dicke_col</span> <span class="o">&gt;</span> <span class="n">dicke_row</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">dicke_row</span> <span class="o">&gt;=</span> <span class="nb">int</span><span class="p">(</span><span class="n">rows</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span> <span class="ow">and</span> <span class="p">(</span><span class="n">rows</span> <span class="o">-</span> <span class="n">dicke_row</span> <span class="o">&lt;=</span> <span class="n">dicke_col</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Pim.tau_valid"><a class="viewcode-back" href="../../piqs.html#piqs.dicke.Pim.tau_valid">[docs]</a>    <span class="k">def</span> <span class="nf">tau_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dicke_row</span><span class="p">,</span> <span class="n">dicke_col</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Find the Tau functions which are valid for this value of (dicke_row,</span>
<span class="sd">        dicke_col) given the number of TLS. This calculates the valid tau</span>
<span class="sd">        values and reurns a dictionary specifying the tau function name and</span>
<span class="sd">        the value.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dicke_row, dicke_col : int</span>
<span class="sd">            Index of the element in Dicke space which needs to be checked.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        taus: dict</span>
<span class="sd">            A dictionary of key, val as {tau: value} consisting of the valid</span>
<span class="sd">            taus for this row and column of the Dicke space element.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tau_functions</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">tau3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tau2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tau4</span><span class="p">,</span>
                         <span class="bp">self</span><span class="o">.</span><span class="n">tau5</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tau1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tau6</span><span class="p">,</span>
                         <span class="bp">self</span><span class="o">.</span><span class="n">tau7</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tau8</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tau9</span><span class="p">]</span>
        <span class="n">N</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">N</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isdicke</span><span class="p">(</span><span class="n">dicke_row</span><span class="p">,</span> <span class="n">dicke_col</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="c1"># The 3x3 sub matrix surrounding the Dicke space element to</span>
        <span class="c1"># run the tau functions</span>
        <span class="n">indices</span> <span class="o">=</span> <span class="p">[(</span><span class="n">dicke_row</span> <span class="o">+</span> <span class="n">x</span><span class="p">,</span> <span class="n">dicke_col</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
                   <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)]</span>
        <span class="n">taus</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">tau</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="n">tau_functions</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isdicke</span><span class="p">(</span><span class="n">idx</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">idx</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                <span class="n">j</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_j_m</span><span class="p">(</span><span class="n">idx</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">idx</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">taus</span><span class="p">[</span><span class="n">tau</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="n">tau</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">taus</span></div>

<div class="viewcode-block" id="Pim.calculate_j_m"><a class="viewcode-back" href="../../piqs.html#piqs.dicke.Pim.calculate_j_m">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_j_m</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dicke_row</span><span class="p">,</span> <span class="n">dicke_col</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the value of j and m for the particular Dicke space element.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dicke_row, dicke_col: int</span>
<span class="sd">            The row and column from the Dicke space matrix</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        j, m: float</span>
<span class="sd">            The j and m values.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">N</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">N</span>
        <span class="n">j</span> <span class="o">=</span> <span class="n">N</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">dicke_col</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">N</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">dicke_row</span>
        <span class="k">return</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span></div>

<div class="viewcode-block" id="Pim.calculate_k"><a class="viewcode-back" href="../../piqs.html#piqs.dicke.Pim.calculate_k">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_k</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dicke_row</span><span class="p">,</span> <span class="n">dicke_col</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get k value from the current row and column element in the Dicke space.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dicke_row, dicke_col: int</span>
<span class="sd">            The row and column from the Dicke space matrix</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        k: int</span>
<span class="sd">            The row index for the matrix M for given Dicke space</span>
<span class="sd">            element</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">N</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">N</span>
        <span class="k">if</span> <span class="n">dicke_row</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">k</span> <span class="o">=</span> <span class="n">dicke_col</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">k</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(((</span><span class="n">dicke_col</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">N</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">dicke_col</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span>
                                      <span class="p">(</span><span class="n">dicke_row</span> <span class="o">-</span> <span class="p">(</span><span class="n">dicke_col</span><span class="p">)))</span>
        <span class="k">return</span> <span class="n">k</span></div>

<div class="viewcode-block" id="Pim.coefficient_matrix"><a class="viewcode-back" href="../../piqs.html#piqs.dicke.Pim.coefficient_matrix">[docs]</a>    <span class="k">def</span> <span class="nf">coefficient_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate the matrix M governing the dynamics.</span>

<span class="sd">        If the initial density matrix and the Hamiltonian is diagonal, the</span>
<span class="sd">        evolution of the system is given by the simple ODE: dp/dt = Mp.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">N</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">N</span>
        <span class="n">nds</span> <span class="o">=</span> <span class="n">num_dicke_states</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">rows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">N</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">cols</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">sparse_M</span> <span class="o">=</span> <span class="n">lil_matrix</span><span class="p">((</span><span class="n">nds</span><span class="p">,</span> <span class="n">nds</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span> <span class="o">%</span> <span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">cols</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cols</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">dicke_row</span><span class="p">,</span> <span class="n">dicke_col</span><span class="p">)</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">ndindex</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isdicke</span><span class="p">(</span><span class="n">dicke_row</span><span class="p">,</span> <span class="n">dicke_col</span><span class="p">):</span>
                <span class="n">k</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">calculate_k</span><span class="p">(</span><span class="n">dicke_row</span><span class="p">,</span> <span class="n">dicke_col</span><span class="p">))</span>
                <span class="n">row</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="n">taus</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tau_valid</span><span class="p">(</span><span class="n">dicke_row</span><span class="p">,</span> <span class="n">dicke_col</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">tau</span> <span class="ow">in</span> <span class="n">taus</span><span class="p">:</span>
                    <span class="n">j</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_j_m</span><span class="p">(</span><span class="n">dicke_row</span><span class="p">,</span> <span class="n">dicke_col</span><span class="p">)</span>
                    <span class="n">current_col</span> <span class="o">=</span> <span class="n">tau_column</span><span class="p">(</span><span class="n">tau</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
                    <span class="n">sparse_M</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">current_col</span><span class="p">)]</span> <span class="o">=</span> <span class="n">taus</span><span class="p">[</span><span class="n">tau</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">sparse_M</span><span class="o">.</span><span class="n">tocsr</span><span class="p">()</span></div>

<div class="viewcode-block" id="Pim.solve"><a class="viewcode-back" href="../../piqs.html#piqs.dicke.Pim.solve">[docs]</a>    <span class="k">def</span> <span class="nf">solve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rho0</span><span class="p">,</span> <span class="n">tlist</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Solve the ODE for the evolution of diagonal states and Hamiltonians.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="n">Options</span><span class="p">()</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">Result</span><span class="p">()</span>
        <span class="n">output</span><span class="o">.</span><span class="n">solver</span> <span class="o">=</span> <span class="s2">&quot;pisolve&quot;</span>
        <span class="n">output</span><span class="o">.</span><span class="n">times</span> <span class="o">=</span> <span class="n">tlist</span>
        <span class="n">output</span><span class="o">.</span><span class="n">states</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">output</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Qobj</span><span class="p">(</span><span class="n">rho0</span><span class="p">))</span>
        <span class="n">rhs_generate</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">y</span><span class="p">,</span> <span class="n">tt</span><span class="p">,</span> <span class="n">M</span><span class="p">:</span> <span class="n">M</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
        <span class="n">rho0_flat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">rho0</span><span class="o">.</span><span class="n">full</span><span class="p">()))</span>
        <span class="n">L</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coefficient_matrix</span><span class="p">()</span>
        <span class="n">rho_t</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="n">rhs_generate</span><span class="p">,</span> <span class="n">rho0_flat</span><span class="p">,</span> <span class="n">tlist</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">L</span><span class="p">,))</span>
        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">rho_t</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
            <span class="n">diag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
            <span class="n">output</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Qobj</span><span class="p">(</span><span class="n">diag</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">output</span></div>

<div class="viewcode-block" id="Pim.tau1"><a class="viewcode-back" href="../../piqs.html#piqs.dicke.Pim.tau1">[docs]</a>    <span class="k">def</span> <span class="nf">tau1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate tau1 for value of j and m.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">yS</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collective_emission</span>
        <span class="n">yL</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">emission</span>
        <span class="n">yD</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dephasing</span>
        <span class="n">yP</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pumping</span>
        <span class="n">yCP</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collective_pumping</span>
        <span class="n">N</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">)</span>
        <span class="n">spontaneous</span> <span class="o">=</span> <span class="n">yS</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">j</span> <span class="o">-</span> <span class="n">m</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="n">m</span><span class="p">)</span>
        <span class="n">losses</span> <span class="o">=</span> <span class="n">yL</span> <span class="o">*</span> <span class="p">(</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">m</span><span class="p">)</span>
        <span class="n">pump</span> <span class="o">=</span> <span class="n">yP</span> <span class="o">*</span> <span class="p">(</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">m</span><span class="p">)</span>
        <span class="n">collective_pump</span> <span class="o">=</span> <span class="n">yCP</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">j</span> <span class="o">+</span> <span class="n">m</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">j</span> <span class="o">-</span> <span class="n">m</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">dephase</span> <span class="o">=</span> <span class="n">yD</span> <span class="o">*</span> <span class="n">N</span><span class="o">/</span><span class="mi">4</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dephase</span> <span class="o">=</span> <span class="n">yD</span> <span class="o">*</span> <span class="p">(</span><span class="n">N</span><span class="o">/</span><span class="mi">4</span> <span class="o">-</span> <span class="n">m</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">j</span> <span class="o">*</span> <span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">))))</span>
        <span class="n">t1</span> <span class="o">=</span> <span class="n">spontaneous</span> <span class="o">+</span> <span class="n">losses</span> <span class="o">+</span> <span class="n">pump</span> <span class="o">+</span> <span class="n">dephase</span> <span class="o">+</span> <span class="n">collective_pump</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">t1</span></div>

<div class="viewcode-block" id="Pim.tau2"><a class="viewcode-back" href="../../piqs.html#piqs.dicke.Pim.tau2">[docs]</a>    <span class="k">def</span> <span class="nf">tau2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate tau2 for given j and m</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">yS</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collective_emission</span>
        <span class="n">yL</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">emission</span>
        <span class="n">N</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">)</span>
        <span class="n">spontaneous</span> <span class="o">=</span> <span class="n">yS</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">j</span> <span class="o">-</span> <span class="n">m</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="n">m</span><span class="p">)</span>
        <span class="n">losses</span> <span class="o">=</span> <span class="n">yL</span> <span class="o">*</span> <span class="p">(((</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">j</span> <span class="o">-</span> <span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="n">m</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">j</span> <span class="o">*</span> <span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)))</span>
        <span class="n">t2</span> <span class="o">=</span> <span class="n">spontaneous</span> <span class="o">+</span> <span class="n">losses</span>
        <span class="k">return</span> <span class="n">t2</span></div>

<div class="viewcode-block" id="Pim.tau3"><a class="viewcode-back" href="../../piqs.html#piqs.dicke.Pim.tau3">[docs]</a>    <span class="k">def</span> <span class="nf">tau3</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate tau3.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">yL</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">emission</span>
        <span class="n">N</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">)</span>
        <span class="n">num</span> <span class="o">=</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="n">m</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="n">m</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">den</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">j</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">t3</span> <span class="o">=</span> <span class="n">yL</span> <span class="o">*</span> <span class="p">(</span><span class="n">num</span><span class="o">/</span><span class="n">den</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">t3</span></div>

<div class="viewcode-block" id="Pim.tau4"><a class="viewcode-back" href="../../piqs.html#piqs.dicke.Pim.tau4">[docs]</a>    <span class="k">def</span> <span class="nf">tau4</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate tau4.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">yL</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">emission</span>
        <span class="n">N</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">)</span>
        <span class="n">num</span> <span class="o">=</span> <span class="p">(</span><span class="n">j</span> <span class="o">-</span> <span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">j</span> <span class="o">-</span> <span class="n">m</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">j</span><span class="p">)</span>
        <span class="n">den</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">t4</span> <span class="o">=</span> <span class="n">yL</span> <span class="o">*</span> <span class="p">(</span><span class="n">num</span><span class="o">/</span><span class="n">den</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">t4</span></div>

<div class="viewcode-block" id="Pim.tau5"><a class="viewcode-back" href="../../piqs.html#piqs.dicke.Pim.tau5">[docs]</a>    <span class="k">def</span> <span class="nf">tau5</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate tau5.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">yD</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dephasing</span>
        <span class="n">N</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">)</span>
        <span class="n">num</span> <span class="o">=</span> <span class="p">(</span><span class="n">j</span> <span class="o">-</span> <span class="n">m</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="n">m</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">den</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">j</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">t5</span> <span class="o">=</span> <span class="n">yD</span> <span class="o">*</span> <span class="p">(</span><span class="n">num</span><span class="o">/</span><span class="n">den</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">t5</span></div>

<div class="viewcode-block" id="Pim.tau6"><a class="viewcode-back" href="../../piqs.html#piqs.dicke.Pim.tau6">[docs]</a>    <span class="k">def</span> <span class="nf">tau6</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate tau6.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">yD</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dephasing</span>
        <span class="n">N</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">)</span>
        <span class="n">num</span> <span class="o">=</span> <span class="p">(</span><span class="n">j</span> <span class="o">-</span> <span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">j</span><span class="p">)</span>
        <span class="n">den</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">t6</span> <span class="o">=</span> <span class="n">yD</span> <span class="o">*</span> <span class="p">(</span><span class="n">num</span><span class="o">/</span><span class="n">den</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">t6</span></div>

<div class="viewcode-block" id="Pim.tau7"><a class="viewcode-back" href="../../piqs.html#piqs.dicke.Pim.tau7">[docs]</a>    <span class="k">def</span> <span class="nf">tau7</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate tau7.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">yP</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pumping</span>
        <span class="n">N</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">)</span>
        <span class="n">num</span> <span class="o">=</span> <span class="p">(</span><span class="n">j</span> <span class="o">-</span> <span class="n">m</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">j</span> <span class="o">-</span> <span class="n">m</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">den</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">j</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">t7</span> <span class="o">=</span> <span class="n">yP</span> <span class="o">*</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">num</span><span class="p">)</span><span class="o">/</span><span class="n">den</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">t7</span></div>

<div class="viewcode-block" id="Pim.tau8"><a class="viewcode-back" href="../../piqs.html#piqs.dicke.Pim.tau8">[docs]</a>    <span class="k">def</span> <span class="nf">tau8</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate tau8.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">yP</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pumping</span>
        <span class="n">yCP</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collective_pumping</span>
        <span class="n">N</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">)</span>

        <span class="n">num</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="n">m</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">den</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">j</span> <span class="o">*</span> <span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">pump</span> <span class="o">=</span> <span class="n">yP</span> <span class="o">*</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">num</span><span class="p">)</span><span class="o">/</span><span class="n">den</span><span class="p">)</span>
        <span class="n">collective_pump</span> <span class="o">=</span> <span class="n">yCP</span> <span class="o">*</span> <span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="n">m</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">t8</span> <span class="o">=</span> <span class="n">pump</span> <span class="o">+</span> <span class="n">collective_pump</span>
        <span class="k">return</span> <span class="n">t8</span></div>

<div class="viewcode-block" id="Pim.tau9"><a class="viewcode-back" href="../../piqs.html#piqs.dicke.Pim.tau9">[docs]</a>    <span class="k">def</span> <span class="nf">tau9</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate tau9.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">yP</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pumping</span>
        <span class="n">N</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">)</span>
        <span class="n">num</span> <span class="o">=</span> <span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="n">m</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">j</span><span class="p">)</span>
        <span class="n">den</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">t9</span> <span class="o">=</span> <span class="n">yP</span> <span class="o">*</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">num</span><span class="p">)</span><span class="o">/</span><span class="n">den</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">t9</span></div></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Nathan Shammah, Shahnawaz Ahmed.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'1.1-dev',
            LANGUAGE:'python',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>